module dir-test
imports liblib
strategies

  main = 
    test-suite(!"dir-test", 
      test1;
      test2;
      test3
    )

  test1 =
    apply-test(!"test1"
	, readdir; fetch-elem(?"dir-test.c")
	, !"."
	, !"dir-test.c"
	)

  test2 =
    apply-and-check(!"test2a"
	, modification-time
	, !"dir-test.str"
	, debug; is-int
	);
    apply-and-check(!"test2b"
	, file-newer
	, !("dir-test.c", "dir-test.str")
	, debug
	)

  test3 =
    apply-and-check(!"test3"
	, getenv
	, !"HOME"
	, debug; is-string
	)
